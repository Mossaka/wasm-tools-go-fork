package wasi:io;

interface poll {
    resource pollable {} // TODO: constructor, methods, and static functions;
    poll-list: func(in: list<borrow<pollable>>) -> list<u32>;
    poll-one: func(in: borrow<pollable>);
}

interface streams {
    resource input-stream {} // TODO: constructor, methods, and static functions;
    resource output-stream {} // TODO: constructor, methods, and static functions;
    use poll.{pollable};
    enum stream-status { open, ended };
    enum write-error {
        last-operation-failed,
        closed
    };
}

world imports {
    import poll;
    import streams;
}


package wasi:clocks;

interface monotonic-clock {
    type instant = u64;
    use wasi:io/poll.{pollable};
    now: func() -> instant;
    resolution: func() -> instant;
    subscribe: func(when: instant, absolute: bool) -> own<pollable>;
}

interface timezone {
    use wall-clock.{datetime};
    record timezone-display {
        utc-offset: s32,
        name: string,
        in-daylight-saving-time: bool
    };
    display: func(when: datetime) -> timezone-display;
    utc-offset: func(when: datetime) -> s32;
}

interface wall-clock {
    record datetime {
        seconds: u64,
        nanoseconds: u32
    };
    now: func() -> datetime;
    resolution: func() -> datetime;
}

world imports {
    import wasi:io/poll;
    import monotonic-clock;
    import wall-clock;
    import timezone;
}
